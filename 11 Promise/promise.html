<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promise</title>
</head>
<body>
    <script>
        // Promise 是异步编程的一种解决方案，代表一个异步操作的最终完成（或失败）及其结果值。
        // 1.基本定义
        let promise = new Promise(function(resolve, reject) {
            // 异步操作
            setTimeout(() => {
                let success = true; // 模拟操作结果
                if (success) {
                    resolve("操作成功"); // 操作成功，调用 resolve
                } else {
                    reject("操作失败"); // 操作失败，调用 reject
                }
            }, 1000);
        });

        promise.then(function(value) {
            console.log(value); // 输出: 操作成功
        }).catch(function(error) {
            console.log(error); // 输出: 操作失败
        });

        // 2.Promise 链式调用,then 方法返回一个新的 Promise 对象，可以进行链式调用，第一个参数是成功回调，第二个参数是失败回调
        let promiseChain = new Promise(function(resolve, reject) {
            resolve(1);
            // reject("错误");
        });

        promiseChain
            .then(function(value) {
                console.log(value); // 输出: 1
                return value + 1;
            },error=>{
                console.log(error); // 输出: 错误
                return 1;
            })
            .then(function(value) {
                console.log(value); // 输出: 2
                return value + 1;
            })
            .then(function(value) {
                console.log(value); // 输出: 3
            })
            .catch(function(error) {
                console.log(error); // 输出: 错误
                return 1;
            });

        // 3.Promise.all ， Promise.race ， Promise.resolve ， Promise.reject ， Promise.finally
        Promise.all([promiseA, promiseB]).then(function(values) {
            console.log(values); // 输出: ["结果 A", "结果 B"]，all 方法等待所有 Promise 完成，如果有一个失败则返回失败结果
        });

        Promise.race([promiseA, promiseB]).then(function(value) {
            console.log(value); // 输出: "结果 A"，因为 promiseA 比 promiseB 先完成，race 方法返回第一个完成的 Promise 结果
        });

        let promiseC = Promise.resolve("结果 C");
        let promiseD = Promise.reject("错误 D");

        promiseC.then(function(value) {
            console.log(value); // 输出: "结果 C"
        });

        promiseD.catch(function(error) {
            console.log(error); // 输出: "错误 D"
        });

        let promiseE = Promise.resolve("结果 E");
        promiseE.finally(function() {
            console.log("finally 执行"); // 输出: "finally 执行"，无论 Promise 状态如何都会执行
        });
        
        let promiseF = Promise.reject("错误 F");
        promiseF.finally(function() {
            console.log("finally 执行"); // 输出: "finally 执行"
        });
        

    </script>
    
</body>
</html>